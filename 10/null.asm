
	ORG	00H
	JMP	INITIAL
	ORG	03H		;中斷向量
	JMP	INTERRUPT
	ORG	50H
INITIAL:
	SETB	IT0		;選擇falling edge trigger
	MOV	IE,#10000001B	;開啟EA、EX0
	MOV	IP,#00000001B	;開啟PX0
	CLR	IE0		;清除中斷旗標
	MOV	R0,#0FFH		;表一開始的位置
	MOV	R1,#0		;搖的次數
	MOV	R2,#0		;指標所在行數
	MOV	R3,#12		;讀一個數字所要的行數
	MOV	DPTR,#ID	;初始化指標位址
MAIN:
	JMP	MAIN		;無窮迴圈
INTERRUPT:
	CJNE	R1,#30,ADDL	;若搖的次數還沒10次，跳到ADDL
	MOV	R1,#0		;若達到10次，計數器歸零
	MOV	A,#36
	ADD	A,R2
	MOV	R2,A		;指標所在位址跳12行(一個數字)
	CJNE	R2,#252,NEXT_COLUMN	;若沒超出TABLE就輸入信號
	MOV	R2,#0H		;超出TABLE就回到起始位址
	CALL	NEXT_COLUMN	;輸入信號
	CLR	IE0		;清除中斷旗標
	RETI
ADDL:
	INC	R1		;搖的次數加一
	CALL	NEXT_COLUMN	;輸入信號
	CLR	IE0		;清除中斷旗標
	RETI
NEXT_COLUMN:
	CALL	READ_BYTE	;讀進一個BYTE
	MOV	P1,A		;把值放進P0
	CALL	READ_BYTE	;讀進一個BYTE
	MOV	P2,A		;把值放進P2
	CALL	READ_BYTE	;讀進一個BYTE
	MOV	P0,A		;把值放進P1
	CALL	DELAY
	DJNZ	R3,NEXT_COLUMN	;換行
	MOV	R3,#12
	MOV	R0,#0FFH
	RETI

;=====READ 1 BYTE FROM TABLE=======================
READ_BYTE:			;讀一個BYTE
	INC	R0		;R0加一
	MOV	A,R0		;把R0放進A
	ADD	A,R2
	MOVC	A,@A+DPTR	;對應到TABLE並把值放進A
	CPL	A		;把A做反向
	RET

DELAY:
	MOV	R6,#050H
DELAY1:
	MOV	R7,#0AFH
DELAY2:
	DJNZ	R7,DELAY2
	DJNZ	R6,DELAY1
	RET
ID:
        DB      0000000B,00000000B,00000000B
        DB      0000001B,11111111B,11100000B
        DB      0000111B,11111111B,11111000B
        DB      0001111B,11111111B,11111100B
        DB      0001111B,00000000B,00111100B
        DB      0001000B,00000000B,00000100B
        DB      0001100B,00000000B,00001100B
        DB      0001111B,10000000B,01111100B
        DB      0001111B,11111111B,11111100B
        DB      0000111B,11111111B,11111000B
        DB      0000000B,11111111B,11000000B
        DB      0000000B,00000000B,00000000B
        
		DB      0000000B,00000000B,00000000B
        DB      0000111B,10001111B,11111100B
        DB      0001111B,10001111B,11111100B
        DB      0001111B,10001111B,11111100B
        DB      0001000B,00000010B,00001100B
        DB      0001000B,00000011B,00001100B
        DB      0001100B,00000011B,00001100B
        DB      0001110B,00000111B,00001100B
        DB      0001111B,11111110B,00001100B
        DB      0000111B,11111110B,00001100B
        DB      0000001B,11111000B,00000000B
        DB      0000000B,00000000B,00000000B

	    DB      0000000B,00000000B,00000000B
        DB      0000000B,00000000B,00000000B
        DB      0001000B,00000000B,00001000B
        DB      0001000B,00000000B,00001000B
        DB      0001111B,11111111B,11111000B
        DB      0001111B,11111111B,11111100B
        DB      0001111B,11111111B,11111100B
        DB      0001000B,00000000B,00000000B
        DB      0001000B,00000000B,00000000B
        DB      0000000B,00000000B,00000000B
        DB      0000000B,00000000B,00000000B
        DB      0000000B,00000000B,00000000B
        
		DB      0000000B,00000000B,00000000B
        DB      0000001B,11111111B,11100000B
        DB      0000111B,11111111B,11111000B
        DB      0001111B,11111111B,11111100B
        DB      0001111B,00000000B,00111100B
        DB      0001000B,00000000B,00000100B
        DB      0001100B,00000000B,00001100B
        DB      0001111B,10000000B,01111100B
        DB      0001111B,11111111B,11111100B
        DB      0000111B,11111111B,11111000B
        DB      0000000B,11111111B,11000000B
        DB      0000000B,00000000B,00000000B

	    DB      0000000B,00000000B,00000000B
        DB      0000000B,00000000B,01111100B
        DB      0000000B,00000000B,01111100B
        DB      0000000B,00000000B,00011100B
        DB      0000111B,00000000B,00001100B
        DB      0001111B,11111000B,00001100B
        DB      0001111B,11111110B,00001100B
        DB      0001111B,11111111B,11001100B
        DB      0000000B,00000011B,11101100B
        DB      0000000B,00000000B,01111100B
        DB      0000000B,00000000B,00111100B
        DB      0000000B,00000000B,00001100B
        
		DB      0000000B,11000000B,00000000B
        DB      0000000B,11110000B,00000000B
        DB      0000000B,11111100B,00000000B
        DB      0000000B,10011111B,00000000B
        DB      0001000B,10000111B,10000000B
        DB      0001000B,10000011B,11100000B
        DB      0001111B,11111111B,11111000B
        DB      0001111B,11111111B,11111100B
        DB      0001111B,11111111B,11111100B
        DB      0001000B,10000000B,00000000B
        DB      0001000B,10000000B,00000000B
        DB      0001000B,10000000B,00000000B

	          DB      0000000B,00000000B,00000000B
        DB      0000011B,11000000B,01110000B
        DB      0001111B,11000000B,11111000B
        DB      0001111B,11000000B,11111100B
        DB      0001100B,10000100B,01001100B
        DB      0011000B,00000100B,00000100B
        DB      0011000B,00001110B,00001100B
        DB      0001100B,00001111B,10011100B
        DB      0001111B,11111111B,11111100B
        DB      0000111B,11111011B,11111000B
        DB      0000011B,11110000B,11110000B
        DB      0000000B,00000000B,00000000B

	END